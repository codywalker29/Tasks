quantile(ManySiblings)
hist(ManySiblings)
hist(ManySiblings)
5
A<-5
A*2
B<-c(A,5,5)
B
B*2
'B'*2
B<-c(A,5,5)
B*2
C<-c(B,6,10)
C*6
D<-c(1,5,10,15,20)
sum(D)
mean(D)
min(D)
E<-c(6,7,8,9,10)
which(E==8)
which(E>8)
E[which(E>8)]
trueMean1<-5
trueSD1<-5
population1<-rnorm(1e6,trueMean1,trueSD1)
trueMean2<-4
trueSD2<-5
population2<-rnorm(1e6,trueMean2,trueSD2)
Size<-50
Sample1<-sample(population1, Size)
Sample2<-sample(population2, Size)
boxplot(Sample1, Sample2)
individual1<-c("B","A")
individual2<-c("A","A")
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2,1)
newBaby<-c(Gam1, Gam2)
head(newBaby)
isHet<-c()
for (i in 1:100) {
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2, 1)
newBaby<-c(Gam1, Gam2)
isHet[i]<-Gam1==Gam2}
sum(isHet)/length(isHet)
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma<-makeFounder("grandma_mom")
MatGrandpa<-makeFounder("grandpa_mom")
PatGrandma<-makeFounder("grandpa_da")
PatGrandpa<-makeFounder("grandpa_da")
Alan<-makeBaby(PatGrandma,PatGrandpa)
Brenda<-makeBaby(MatGrandma, MatGrandpa)
Focus<-makeBaby(Brenda, Alan)
ToMom<-length(grep("mom",Focus))/length(Focus)
ToMomMom<-length(grep("grandma_mom",Focus))/length(Focus)
ToMomDad<-length(grep("grand_mom",Focus))/length(Focus)
Sibling_01<-makeBaby(Brenda, Alan)
head(Sibling_01)
ToSib<-length(intersect(Focus, Sibling_01))/length(Focus)
head(ToSib)
ManySiblings<-replicate(1e3,length(intersect(Focus, makeBaby(
Brenda, Alan)))/length(Focus))
quantile(ManySiblings)
hist(ManySiblings)
B<-c(A,5,5)
B*2
C<-c(B,6,10)
C*6
D<-c(1,5,10,15,20)
sum(D)
mean(D)
min(D)
E<-c(6,7,8,9,10)
which(E==8)
which(E>8)
E[which(E>8)]
trueMean1<-5
trueSD1<-5
population1<-rnorm(1e6,trueMean1,trueSD1)
trueMean2<-4
trueSD2<-5
population2<-rnorm(1e6,trueMean2,trueSD2)
Size<-50
Sample1<-sample(population1, Size)
Sample2<-sample(population2, Size)
boxplot(Sample1, Sample2)
individual1<-c("B","A")
individual2<-c("A","A")
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2,1)
newBaby<-c(Gam1, Gam2)
head(newBaby)
isHet<-c()
for (i in 1:100) {
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2, 1)
newBaby<-c(Gam1, Gam2)
isHet[i]<-Gam1==Gam2}
sum(isHet)/length(isHet)
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma<-makeFounder("grandma_mom")
MatGrandpa<-makeFounder("grandpa_mom")
PatGrandma<-makeFounder("grandpa_da")
PatGrandpa<-makeFounder("grandpa_da")
Alan<-makeBaby(PatGrandma,PatGrandpa)
Brenda<-makeBaby(MatGrandma, MatGrandpa)
Focus<-makeBaby(Brenda, Alan)
ToMom<-length(grep("mom",Focus))/length(Focus)
ToMomMom<-length(grep("grandma_mom",Focus))/length(Focus)
ToMomDad<-length(grep("grand_mom",Focus))/length(Focus)
Sibling_01<-makeBaby(Brenda, Alan)
head(Sibling_01)
ToSib<-length(intersect(Focus, Sibling_01))/length(Focus)
head(ToSib)
ManySiblings<-replicate(1e3,length(intersect(Focus, makeBaby(Brenda, Alan)))/length(Focus))
quantile(ManySiblings)
hist(ManySiblings)
5
A<-5
A*2
B<-c(A,5,5)
B
B*2
'B'*2
B<-c(A,5,5)
B*2
C<-c(B,6,10)
C*6
D<-c(1,5,10,15,20)
sum(D)
mean(D)
min(D)
E<-c(6,7,8,9,10)
which(E==8)
which(E>8)
E[which(E>8)]
trueMean1<-5
trueSD1<-5
population1<-rnorm(1e6,trueMean1,trueSD1)
trueMean2<-4
trueSD2<-5
population2<-rnorm(1e6,trueMean2,trueSD2)
Size<-50
Sample1<-sample(population1, Size)
Sample2<-sample(population2, Size)
boxplot(Sample1, Sample2)
individual1<-c("B","A")
individual2<-c("A","A")
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2,1)
newBaby<-c(Gam1, Gam2)
head(newBaby)
isHet<-c()
for (i in 1:100) {
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2, 1)
newBaby<-c(Gam1, Gam2)
isHet[i]<-Gam1==Gam2}
sum(isHet)/length(isHet)
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma<-makeFounder("grandma_mom")
MatGrandpa<-makeFounder("grandpa_mom")
PatGrandma<-makeFounder("grandpa_da")
PatGrandpa<-makeFounder("grandpa_da")
Alan<-makeBaby(PatGrandma,PatGrandpa)
Brenda<-makeBaby(MatGrandma, MatGrandpa)
Focus<-makeBaby(Brenda, Alan)
ToMom<-length(grep("mom",Focus))/length(Focus)
ToMomMom<-length(grep("grandma_mom",Focus))/length(Focus)
ToMomDad<-length(grep("grand_mom",Focus))/length(Focus)
Sibling_01<-makeBaby(Brenda, Alan)
head(Sibling_01)
ToSib<-length(intersect(Focus, Sibling_01))/length(Focus)
head(ToSib)
ManySiblings<-replicate(1e3,length(intersect(Focus, makeBaby(Brenda, Alan)))/length(Focus))
quantile(ManySiblings)
hist(ManySiblings)
xlimb=0
hist(ManySiblings)(xlimb=0)
hist((ManySiblings),xlimb=0))
hist(ManySiblings),(xlimb=0)
5
A<-5
A*2
B<-c(A,5,5)
B
B*2
'B'*2
B<-c(A,5,5)
B*2
C<-c(B,6,10)
C*6
D<-c(1,5,10,15,20)
sum(D)
mean(D)
min(D)
E<-c(6,7,8,9,10)
which(E==8)
which(E>8)
E[which(E>8)]
trueMean1<-5
trueSD1<-5
population1<-rnorm(1e6,trueMean1,trueSD1)
trueMean2<-4
trueSD2<-5
population2<-rnorm(1e6,trueMean2,trueSD2)
Size<-50
Sample1<-sample(population1, Size)
Sample2<-sample(population2, Size)
boxplot(Sample1, Sample2)
individual1<-c("B","A")
individual2<-c("A","A")
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2,1)
newBaby<-c(Gam1, Gam2)
head(newBaby)
isHet<-c()
for (i in 1:100) {
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2, 1)
newBaby<-c(Gam1, Gam2)
isHet[i]<-Gam1==Gam2}
sum(isHet)/length(isHet)
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma<-makeFounder("grandma_mom")
MatGrandpa<-makeFounder("grandpa_mom")
PatGrandma<-makeFounder("grandpa_da")
PatGrandpa<-makeFounder("grandpa_da")
Alan<-makeBaby(PatGrandma,PatGrandpa)
Brenda<-makeBaby(MatGrandma, MatGrandpa)
Focus<-makeBaby(Brenda, Alan)
ToMom<-length(grep("mom",Focus))/length(Focus)
ToMomMom<-length(grep("grandma_mom",Focus))/length(Focus)
ToMomDad<-length(grep("grand_mom",Focus))/length(Focus)
Sibling_01<-makeBaby(Brenda, Alan)
head(Sibling_01)
ToSib<-length(intersect(Focus, Sibling_01))/length(Focus)
head(ToSib)
ManySiblings<-replicate(1e3,length(intersect(Focus, makeBaby(Brenda, Alan)))/length(Focus))
quantile(ManySiblings)
hist(ManySiblings),(xlimb=0)
quantile(ManySiblings)
hist(ManySiblings)
mean(ManySiblings)
hist(ManySiblings)
5
A<-5
A*2
B<-c(A,5,5)
B
B*2
'B'*2
B<-c(A,5,5)
B*2
C<-c(B,6,10)
C*6
D<-c(1,5,10,15,20)
sum(D)
mean(D)
min(D)
E<-c(6,7,8,9,10)
which(E==8)
which(E>8)
E[which(E>8)]
trueMean1<-5
trueSD1<-5
population1<-rnorm(1e6,trueMean1,trueSD1)
trueMean2<-4
trueSD2<-5
population2<-rnorm(1e6,trueMean2,trueSD2)
Size<-50
Sample1<-sample(population1, Size)
Sample2<-sample(population2, Size)
boxplot(Sample1, Sample2)
individual1<-c("B","A")
individual2<-c("A","A")
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2,1)
newBaby<-c(Gam1, Gam2)
head(newBaby)
isHet<-c()
for (i in 1:100) {
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2, 1)
newBaby<-c(Gam1, Gam2)
isHet[i]<-Gam1==Gam2}
sum(isHet)/length(isHet)
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma<-makeFounder("grandma_mom")
MatGrandpa<-makeFounder("grandpa_mom")
PatGrandma<-makeFounder("grandpa_da")
PatGrandpa<-makeFounder("grandpa_da")
Alan<-makeBaby(PatGrandma,PatGrandpa)
Brenda<-makeBaby(MatGrandma, MatGrandpa)
Focus<-makeBaby(Brenda, Alan)
ToMom<-length(grep("mom",Focus))/length(Focus)
ToMomMom<-length(grep("grandma_mom",Focus))/length(Focus)
ToMomDad<-length(grep("grand_mom",Focus))/length(Focus)
Sibling_01<-makeBaby(Brenda, Alan)
head(Sibling_01)
ToSib<-length(intersect(Focus, Sibling_01))/length(Focus)
head(ToSib)
ManySiblings<-replicate(1e3,length(intersect(Focus, makeBaby(Brenda, Alan)))/length(Focus))
quantile(ManySiblings)
mean(ManySiblings)
hist(ManySiblings)
5
A<-5
A*2
B<-c(A,5,5)
B
B*2
'B'*2
B<-c(A,5,5)
B*2
C<-c(B,6,10)
C*6
D<-c(1,5,10,15,20)
sum(D)
mean(D)
min(D)
E<-c(6,7,8,9,10)
which(E==8)
which(E>8)
E[which(E>8)]
trueMean<-5
trueSD1<-5
popultaion1<-rnorm(1e6,trueMean1,trueSD1)
trueMean2<-4
trueSD2<-5
population2<-rnorm(1e6,trueMean2,trueSD2)
Size<-50
Sample1<-sample(population1,Size)
Sample2<-sample(population2,Size)
boxplot(Sample1,Sample2)
individual1<-c("B","A")
individual2<-c("A","A")
Gam1<-sample(individual1,1)
Gam2<-sample(individual2,1)
newBaby<-c(Gam1,Gam2)
isHet<-c()
for(i in 1:100) {
Gam1<-sample(individual1,1)
Gam2<-sample(individual2,1)
newBaby<-(Gam1,Gam2)
for(i in 1:100) {
Gam1<-sample(individual1, 1)
Gam2<-sample(individual2, 1)
newBaby<-(Gam1,Gam2)
for(i in 1:100) {Gam1<-sample(individual1, 1) Gam2<-sample(individual2, 1) newBaby<-(Gam1,Gam2)isHet[i]<-Gam1==Gam2}
for (i in 1:100) {
Gam1<-sample(individual1, 1)
Game2<-sample(individual2, 1)
newBaby<-c(Gam1, Gam2)
isHet[i]<-Gam1==Gam2
}
sum(isHet)/length(isHet)
source("https://jonsmitchell.com/code/sinFxn04.R")
source("http://jonsmitchell.com/code/sinFxn04.R")
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma<-makeFounder("grandma_mom")
MatGrandpda<-makeFounder("granpa_mom")
PatGrandpa<-makeFounder("grandpa_da")
Alan<-makeBaby(PatGrandma,PatGrandpa)
Brenda<-makeBaby(MatGrandma,MatGrandpa)
Focus<-makeBaby(Brenda,Alan)
ToMom<-length(grep("mom",Focus))/length(Focus)
ToMomMom<-length(grep("grandma_mom",Focus))/length(Focus)
ToMomDad<-length(grep("grandpa_mom",Focus))/length(Focus)
Sibling_01<-makeBaby(Brenda,Alan)
ToSib<-length(intersect(Focus, Sibling_01))/length(Focus)
ManySiblings<-replicate(1e3,length(intersect(Focus,makeBaby(Brenda, Alan)))/length(Focus))
quantile(ManySiblings)
mean(ManySiblings)
hist(ManySiblings)
5
A<-5
A*2
B<-c(A,5,5)
B
B*2
'B'*2
B<-c(A,5,5)
B*2
C<-c(B,6,10)
C*6
D<-c(1,5,10,15,20)
sum(D)
mean(D)
min(D)
E<-c(6,7,8,9,10)
which(E==8)
which(E>8)
E[which(E>8)]
trueMean<-5
trueSD1<-5
popultaion1<-rnorm(1e6,trueMean1,trueSD1)
trueMean2<-4
trueSD2<-5
population2<-rnorm(1e6,trueMean2,trueSD2)
Size<-50
Sample1<-sample(population1,Size)
Sample2<-sample(population2,Size)
boxplot(Sample1,Sample2)
individual1<-c("B","A")
individual2<-c("A","A")
Gam1<-sample(individual1,1)
Gam2<-sample(individual2,1)
newBaby<-c(Gam1,Gam2)
isHet<-c()
for (i in 1:100) {
Gam1<-sample(individual1, 1)
Game2<-sample(individual2, 1)
newBaby<-c(Gam1, Gam2)
isHet[i]<-Gam1==Gam2
}
sum(isHet)/length(isHet)
source("http://jonsmitchell.com/code/simFxn04.R")
MatGrandma<-makeFounder("grandma_mom")
MatGrandpda<-makeFounder("granpa_mom")
PatGrandma<-makeFounder("grandma_da")
PatGrandpa<-makeFounder("grandpa_da")
Alan<-makeBaby(PatGrandma,PatGrandpa)
Brenda<-makeBaby(MatGrandma,MatGrandpa)
Focus<-makeBaby(Brenda,Alan)
ToMom<-length(grep("mom",Focus))/length(Focus)
ToMomMom<-length(grep("grandma_mom",Focus))/length(Focus)
ToMomDad<-length(grep("grandpa_mom",Focus))/length(Focus)
Sibling_01<-makeBaby(Brenda,Alan)
ToSib<-length(intersect(Focus, Sibling_01))/length(Focus)
ManySiblings<-replicate(1e3,length(intersect(Focus,makeBaby(Brenda, Alan)))/length(Focus))
quantile(ManySiblings)
mean(ManySiblings)
hist(ManySiblings)
hist(ManySiblings)
snpgeno<-snpgeno[,!colnames(snpgeno)%in%snps_to_remove]
setwd('C:\\Users\\Jimmy\\Desktop\\Evolution\\Tasks\\Task_05')
library(adegenet)
library(poppr)
library(dplyr)
library(hierfstat)
library(reshape2)
library(ggplot2)
library(RColorBrewer)
library(scales)
lobster<-read.csv("https://jonsmitchell.com/data/lobster_genotypes.csv")
lobster_wide<-reshape(lobster,idvar=c("ID","Site"),timevar="Locus",direction="wide",sep="")
colnames(lobster_wide)<-gsub("Genotype","",colnames(lobster_wide))
snpgeno<-lobster_wide[,3:ncol(lobster_wide)]
snps_to_remove<-c("25580","32362","41521","53889","65376","8953","21197","15531","22740","28357","33066","51507"."53052","53263","21880","22323","22365")
snps_to_remove<-c("25580","32362","41521","53889","65376","8953","21197","15531","22740","28357","33066","51507","53052","53263","21880","22323","22365")
snpgeno<-snpgeno[,!colnames(snpgeno)%in%snps_to_remove]
ind<-as.character(lobster_wide$ID)
site<-as.character(lobster_wide$Site)
lobster_gen<-df2genind(snpgeno,ploidy=2,ind.names=ind,pop=site,sep="")
lobster_gen<-missingno(lobster_gen,type="geno",sutoff=0.20)
lobster_gen<-missingno(lobster_gen,type="geno",cutoff=0.20)
mlg(lobster_gen)
dups_lobster<-mlg.id(lobster_gen)
lob_dups<-c()
x<-1
for(i in dups_lobster){
if (length(dups_lobster[i])>1){
x<-x+1
}
}
lob_Nodups<-indNames(lobster_gen)[! indNames(lobster_gen) %in%lob_dups]
lobster_gen<-lobster-gen[Nodups,]
lobster_gen<-lobster_gen[Nodups,]
lobster_gen<-lobster_gen[lob_Nodups,]
summary(lobster_gen$pop)
basic_lobster<-basic.stats(lobster_gen,diploid=TRUE)
Ho_lobster<-round(apply(basic_lobster$Ho,MARGIN=2,FUN=mean,na.rm=TRUE)digits=3)
Ho_lobster<-round(apply(basic_lobster$Ho,MARGIN=2,FUN=mean,na.rm=TRUE),digits=3)
He_lobster<-round(apply(basic_lobster$Hs,MARGIN=2,FUN=mean,na.rm=TRUE),digits=3)
par(mar=c(4,4,1,1),las=1,mgp=c(2,0.25,0),tck=-0.005,cex.lab=1.25)
plot(He_lobster,Ho_lobster,xlab="expected H",ylab="observed H",pch=21,bg="gray",xlim=c(0.32,0.405),ylim=c(0.32,0.405))
abline(0,1,lty=3)
abline(lm(Ho_lobster~He_lobster),lty=2,lwd=1.25,col='red')
Fis<-apply(basic_lobster$Fis,MARGIN=2,FUN=mean, na.rm=TRUE)
lobster_gen_sub<-popsub(lobster_gen,sublist=c("Ale","Ber","Brd","Pad","Sar17","Vig"))
lobster_fst<-genet.dist(lobster_gen_sub,method="WC84")%>%round(digits=3)
lab_order<-c("Ber","Brd","Pad","Vig","Sar17","Ale")
fst.mat<-as.matrix(lobster_fst)
fst.mat1<-fst.mat[lab_order,]
fst.mat2<-fst.mat[,lab_order]
ind<-which(upper.tri(fst.mat2),arr.ind=TRUE)
fst.df<-data.frame(Site=dimnames(fst.mat2)[[2]][ind[,2]],
Site2=dimnames(fst.mat2)[[1]][ind[,1]],
Fst=fst.mat2[ind])
fst.df$Site1<-factor(fst.df$Site1,levels=unique(fst.df$Site1))
fst.df$Site1<-factor(fst.df$Site1,levels=unique(fst.df$Site1))
fst.mat<-as.matrix(lobster_fst)
fst.mat1<-fst.mat[lab_order,]
fst.mat2<-fst.mat1[,lab_order]
ind<-which(upper.tri(fst.mat2),arr.ind=TRUE)
fst.df<-data.frame(Site=dimnames(fst.mat2)[[2]][ind[,2]],
Site2=dimnames(fst.mat2)[[1]][ind[,1]],
Fst=fst.mat2[ind])
fst.df$Site1<-factor(fst.df$Site1,levels=unique(fst.df$Site1))
Fis<-apply(basic_lobster$Fis,MARGIN=2,FUN=mean, na.rm=TRUE)
lobster_gen_sub<-popsub(lobster_gen,sublist=c("Ale","Ber","Brd","Pad","Sar17","Vig"))
lobster_fst<-genet.dist(lobster_gen_sub,method="WC84")%>%round(digits=3)
lab_order<-c("Ber","Brd","Pad","Vig","Sar17","Ale")
fst.mat<-as.matrix(lobster_fst)
fst.mat1<-fst.mat[lab_order,]
fst.mat2<-fst.mat1[,lab_order]
ind<-which(upper.tri(fst.mat2),arr.ind=TRUE)
fst.df<-data.frame(Site=dimnames(fst.mat2)[[2]][ind[,2]],
Site2=dimnames(fst.mat2)[[1]][ind[,1]],
Fst=fst.mat2[ind])
fst.df$Site1<-factor(fst.df$Site1,levels=unique(fst.df$Site1))
